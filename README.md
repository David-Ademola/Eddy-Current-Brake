# Eddy Current Brake Simulation and Prediction

This project involves simulating the behavior of an eddy current brake and building a neural network model to predict the torque generated by the brake based on excitation current and shaft speed. The project consists of two main components: generating the dataset and building/training the neural network model.

## Dataset Generation (`dataset.py`)

This script generates a dataset of torque values for different combinations of excitation current and shaft speed. The torque is calculated using the following parameters and formulas:

### Constants and Parameters
- `min_current`, `max_current`, `current_step`: Range and step size for excitation current (A)
- `min_omega`, `max_omega`, `omega_step`: Range and step size for shaft speed (RPM)
- `mu_0`: Permeability of free space (H/m)
- `N_TURNS`: Number of turns per pole
- `GAP_WIDTH`: Air-gap width (m)
- `SIGMA`: Conductivity of disk (S/m)
- `RADIUS`: Radius of electromagnet (m)
- `THICKNESS`: Thickness of disk (m)
- `k`: Constant, adjust based on empirical data

### Function
- `calculate_torque(input_current: float, shaft_speed: float) -> float`: Calculates the torque based on the given current and speed.

### Process
1. Calculate torque for all combinations of currents and speeds.
2. Store the results in a pandas DataFrame.
3. Save the DataFrame to a CSV file named `eddy_current_brake_dataset.csv`.

### Usage
Run the script to generate the dataset:
```sh
python dataset.py
```

## Neural Network Model (`main.py`)

This script builds and trains a neural network model to predict the torque generated by the eddy current brake based on excitation current and shaft speed.

### Steps

1. **Load the Data**
   - Load the generated dataset from `eddy_current_brake_dataset.csv`.

2. **Preprocess the Data**
   - Separate features (excitation current, shaft speed) and target (torque).
   - Normalize the target variable using `MinMaxScaler`.
   - Split the data into training and testing sets.
   - Scale the features using `StandardScaler`.

3. **Build the Neural Network**
   - Clear any previous session.
   - Define a Sequential model with two hidden layers of 128 neurons each and ReLU activation, and an output layer with linear activation.
   - Compile the model using Adam optimizer and Mean Squared Error loss function.

4. **Train the Model**
   - Define a learning rate scheduler and early stopping callback.
   - Train the model with a validation split and use the callbacks.

5. **Evaluate the Model**
   - Plot the validation loss and mean absolute error.
   - Evaluate the model on the test set and print the results.
   - Make predictions and compare them with true values.
   - Save the trained model to a file named `EddyCurrentBrakeModel.keras`.

### Usage
Run the script to train the model and make predictions:
```sh
python main.py
```

## Dependencies

- Python 3.x
- NumPy
- Pandas
- Matplotlib
- TensorFlow 2.15.0
- Scikit-learn

Install the required packages using:
```sh
pip install -r requirements.txt
```

## Outputs

- `eddy_current_brake_dataset.csv`: Generated dataset containing excitation current, shaft speed, and calculated torque.
- `EddyCurrentBrakeModel.keras`: Trained neural network model.
- `results.csv`: Predicted vs true torque values for the test set.

## Example Outputs

### Dataset Example
First few rows of `eddy_current_brake_dataset.csv`:
```
Excitation Current (A) | Shaft Speed (RPM) | Torque (Nm)
----------------------------------------------------------------
         0.5           |       0           |    0.0
         0.5           |      10           | 10013832.220070612
         0.5           |      20           | 20027664.440141223
...
```

### Model Training Output
```
Mean Absolute Error: 0.0014
Loss: 0.0000
```

### Predictions Example
First few rows of `results.csv`:
```
True Torque (Nm) | Predicted Torque (Nm)
------------------------------------------
6408852620.84519 | 6451710500.0
8151259427.13747 | 8007936000.0
8972393669.18326 | 9023850000.0
...
```

## License

This project is licensed under the MIT License. See the LICENSE file for more details.